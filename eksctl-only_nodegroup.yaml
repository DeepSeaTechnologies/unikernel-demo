# Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
# SPDX-License-Identifier: Apache-2.0

apiVersion: eksctl.io/v1alpha5
kind: ClusterConfig
metadata:
  name: unikernel-test
  region: eu-north-1
  version: "1.30"
nodeGroups:
  - name: nonmanaged-ng-test-1
    instanceType: c5.metal
    amiFamily: Ubuntu2204
    ami: ami-053f81caf652e695c
    maxPodsPerNode: 100  
    overrideBootstrapCommand: |
      #!/bin/bash

      source /var/lib/cloud/scripts/eksctl/bootstrap.helper.sh

      /etc/eks/bootstrap.sh ${CLUSTER_NAME} --container-runtime containerd --kubelet-extra-args "--node-labels=${NODE_LABELS}"
    minSize: 1
    maxSize: 3
    desiredCapacity: 1
    volumeSize: 73
    ssh:
      publicKeyPath: ~/.ssh/id_rsa-unikernel-test.pub
    labels:
      alpha.eksctl.io/cluster-name: unikernel-test
      alpha.eksctl.io/nodegroup-name: nonmanaged-ng-test-1
